# PDF 批量提取性能测试报告

**测试日期**: 2025-12-10  
**测试源目录**: `D:\Study\JAVA学习`  
**文件总数**: 193 个 PDF 文件  
**总页数**: 9894 页 (平均 51.3 页/文件)
**测试环境**: Windows, PyMuPDF (fitz)

## 1. 测试结果汇总

针对同一批 PDF 文件，我们在 6 种不同模式下进行了全量提取测试，结果如下：

| 测试模式 | 耗时 (秒) | 平均耗时 (秒/文件) | 处理速度 (页/秒) | 说明 |
| :--- | :--- | :--- | :--- | :--- |
| **纯图片提取** (Only Image) | **38.83** | 0.20 | ~255 | 仅提取图片，速度最快 |
| **快速文本** (Fast No Image/Table) | **43.74** | 0.23 | **~226** | 跳过表格检测，仅提取文本 |
| **快速文本+图片** (Fast With Image) | **52.13** | 0.27 | ~190 | 跳过表格检测，提取文本和图片 |
| **标准文本** (Standard No Image) | **53.58** | 0.28 | ~184 | 含表格检测，仅提取文本 |
| **纯表格提取** (Table Only) | **64.72** | 0.34 | ~152 | 仅提取表格结构 |
| **标准文本+图片** (Standard With Image) | **104.46** | 0.54 | ~95 | 全功能模式：含表格检测、文本及图片 |

## 2. 竞品对比分析 (vs Node.js 工具)

基于实际运行数据，与市场上某主流 Node.js PDF 处理工具的官方基准数据进行对比。

**测试对象**: 50页左右的 PDF 文档
*   **本方案**: Python (PyMuPDF) + 多进程并行
*   **竞品**: Node.js + 自动并行

| 比较维度 | 本方案 (Fast Mode) | 本方案 (Standard Mode) | 竞品 (Parallel) | 性能倍数 |
| :--- | :--- | :--- | :--- | :--- |
| **50页 PDF 耗时** | **~0.23 秒** 🚀 | ~0.54 秒 | ~1.00 秒 | **快 4.3 倍** |
| **处理速度** | **~226 页/秒** | ~95 页/秒 | ~50 页/秒 | **快 4.5 倍** |
| **100页 PDF 预估** | **~0.46 秒** | ~1.08 秒 | ~2.00 秒 | **快 4.3 倍** |

**结论**: 
得益于 PyMuPDF (C语言底层) 的高效解析引擎以及 Python 的多进程并行架构，本方案在处理同等规模文档时，**速度是竞品 Node.js 方案的 4 倍以上**。即使开启最耗时的全功能模式（表格+图片），速度依然与竞品的纯文本/快速模式相当。

## 3. 性能分析

1.  **图片提取的影响**
    *   在标准模式下，开启图片提取使总耗时从 **53.58s** 增加到 **104.46s**，耗时几乎翻倍。这主要是由于图片数据的解码和磁盘写入开销。
    *   在快速模式下（跳过表格检测），图片提取带来的额外开销相对较小（从 43.74s 到 52.13s）。

2.  **表格检测的影响**
    *   对比“标准文本 (53.58s)”与“快速文本 (43.74s)”，开启表格检测增加了约 **22%** 的处理时间。对于对表格结构要求不高的场景，使用快速模式可以显著提升效率。

3.  **综合建议**
    *   **追求速度**: 推荐使用 **快速文本模式** (`skip_table_detection=True`)。
    *   **图文并茂**: 推荐使用 **标准文本+图片模式**，虽然耗时较长，但能获得最完整的文档还原。
    *   **数据分析**: 如果重点在于提取数据表，建议单独运行 **纯表格提取** 任务。

## 4. 输出目录结构

所有测试结果均保存在 `output` 目录下，按模式分类：

```text
output/
├── output_standard_with_image/       # 标准模式 (Markdown + 图片)
├── output_standard_no_image/         # 标准模式 (纯 Markdown)
├── output_only_table/                # 仅表格 (Markdown)
├── output_only_image/                # 仅图片 (原图格式)
├── output_fast_no_image_and_table/   # 快速模式 (纯 Markdown)
└── output_fast_with_image_no_table/  # 快速模式 (Markdown + 图片)
```

## 5. 目录保持

所有模式均保持了源文件夹的层级结构。例如：

*   源文件: `D:\Study\JAVA学习\1.JAVA 快速入门\章节1...\test.pdf`
*   输出文件: `output\...\1.JAVA 快速入门\章节1...\test.md`
